# なろう系アニメデータ管理ツール 設計書

## 概要
このツールは、なろう系アニメ診断アプリケーション用のデータ（animes.json、questions.json）を視覚的に作成・編集するためのデスクトップアプリケーションです。

## システム要件

### 基本機能
1. アニメ管理
   - アニメの一覧表示と検索
   - 新規アニメの追加
     * 基本情報（id, title, imageUrl, description）の入力
     * 各質問に対する属性値（true/false）の設定
   - 既存アニメの編集・削除
   - 画像URLのプレビュー表示

2. 質問管理
   - 質問の一覧表示と検索
   - 新規質問の追加
     * 基本情報（id, text, attribute, weight）の入力
     * 各アニメの属性値（true/false）の設定
   - 既存質問の編集・削除

3. データ連携
   - 質問追加時、全アニメの属性値を設定
   - アニメ追加時、全質問の属性値を設定
   - JSON形式でのデータ保存
   - データのエクスポート/インポート機能

## 技術スタック
- フロントエンド
  * React 18.x
  * Ant Design 5.x
  * Electron
- 開発環境
  * JavaScript
  * npm
  * Vite

## ディレクトリ構造
```
tool/
├── package.json
├── src/
│   ├── main.js              # Electron メインプロセス
│   ├── index.jsx           # Reactアプリケーションのエントリーポイント
│   ├── index.css           # グローバルスタイル
│   ├── App.jsx            # メインアプリケーションコンポーネント
│   ├── preload.js           # プリロードスクリプト
│   ├── components/
│   │   ├── anime/
│   │   │   ├── AnimeEditor.jsx     # アニメ編集画面
│   │   │   ├── AnimeForm.jsx       # アニメ基本情報フォーム
│   │   │   └── AttributeForm.jsx    # 質問別属性設定フォーム
│   │   ├── question/
│   │   │   ├── QuestionEditor.jsx  # 質問編集画面
│   │   │   ├── QuestionForm.jsx    # 質問基本情報フォーム
│   │   │   └── AnimeAttributes.jsx  # アニメ別属性設定フォーム
│   │   └── shared/
│   │       ├── JsonPreview.jsx     # JSON形式プレビュー
│   │       ├── ImagePreview.jsx    # 画像プレビュー
│   │       └── Toolbar.jsx         # ツールバー
│   ├── store/
│   │   ├── animeStore.js    # アニメデータの状態管理
│   │   └── questionStore.js # 質問データの状態管理
├── index.html               # メインのHTMLファイ作
```

## UI設計

### メイン画面レイアウト
```
+----------------------------------------------------------+
| [新規作成] [インポート] [エクスポート] [保存] [プレビュー] |
+----------------------------------------------------------+
|  [アニメ] [質問]                                          |
|  +------------------------------------------------------+|
|  | リスト                    | 編集フォーム              ||
|  | +--------------------+    | +--------------------+    ||
|  | | ・項目1            |    | | 基本情報           |    ||
|  | | ・項目2            |    | | [入力フォーム]     |    ||
|  | | ・項目3            |    | |                    |    ||
|  | |                    |    | | 属性設定           |    ||
|  | |                    |    | | [Yes/Noボタン群]   |    ||
|  | |                    |    | |                    |    ||
|  | |                    |    | |                    |    ||
|  | +--------------------+    | +--------------------+    ||
|  +------------------------------------------------------+|
|                                                          ||
|  プレビュー                                              ||
|  +------------------------------------------------------+|
|  | {JSON形式でのプレビュー表示}                          ||
|  +------------------------------------------------------+|
+----------------------------------------------------------+
```

## データ構造

### animes.json
```javascript
{
  "animes": [
    {
      "id": "string",
      "title": "string",
      "imageUrl": "string",
      "description": "string",
      "attributes": {
        [key: string]: boolean
      }
    }
  ]
}
```

### questions.json
```javascript
{
  "questions": [
    {
      "id": "string",
      "text": "string",
      "attribute": "string",
      "weight": number
    }
  ]
}
```

## 実装の注意点

1. データの保存
   - 一括保存方式を採用
   - 保存前に必ずバリデーションを実行
   - エラーが発生した場合は適切なエラーメッセージを表示

2. バリデーション
   - 基本スキーマの検証
   - 属性の整合性チェック
   - 参照整合性のチェック

3. エラー処理
   - バリデーションエラーの明確な表示
   - ファイル操作エラーのハンドリング
   - ユーザーフレンドリーなエラーメッセージ

## 拡張性への配慮

1. 新しい属性の追加
   - 属性の追加が容易な設計
   - 既存データとの互換性維持

2. インターフェースの拡張
   - 新機能追加を考慮したコンポーネント設計
   - モジュール性の高い構造

3. データ形式の変更
   - データ構造の変更に対応できる柔軟な設計
   - マイグレーション機能の実装を考慮